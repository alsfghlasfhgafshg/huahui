<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1"/> -->
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes"/>
    <title>Login</title>
    <link rel="stylesheet" href="css/public.css"/>
    <link rel="stylesheet" href="css/login.css">
    <script src="js/jquery.min.js"></script>
    <!-- <script src="../js/publicSize.js"></script> -->
</head>
<body>
<div class="login">
    <h1>花惠后台管理系统</h1>
    <div class="box">
        <div class="line"></div>
        <div class="title">登录</div>
        <input type="text" placeholder="请输入用户名" id="username">
        <input type="password" placeholder="请输入登录密码" id="password">
        <div class="rember">
            <label for="J_radio">
                <input type="radio" name="remember-me" id="J_radio" value="0">
                记住我
            </label>
        </div>
        <button id="loginbtn">登录</button>

    </div>
</div>
<script type="text/javascript">

    $(function () {


        $('#J_radio').on('click', function () {
            ischecked = $(this).data('checked');
            if (!ischecked && this.checked) {
                $(this).data('checked', true);
            } else {
                $(this).prop('checked', false);
                $(this).data('checked', false);
            }
            console.log($(this).data('checked'))
        }).data('checked', $('#J_radio').get(0).checked);

        $('#loginbtn').on('click', function () {

            var rememberme;

            if ($('#J_radio').is(":checked")) {
                rememberme = "on";
            } else {
                rememberme = "off";
            }
            $.ajax({
                method: "POST",
                url: "/login",
                data: {
                    "username": $("#username").val(),
                    "password": $("#password").val(),
                    "remember-me": rememberme
                },
                success: function (data) {
                    if (data["code"]==0){
                        var role = data["data"]["role"];
                        if (role=="admin"){
                            window.location="/manage/admin.html"
                        }else if(role=="brand"){
                            window.location="/manage/brand.html"
                        }else if(role=="shop"){
                            window.location="/manage/shop.html"
                        }

                    }else {
                        alert(data["msg"])
                    }
                },
                error: function () {
                    toastr.error("error!");
                }
            })
        });


    })

</script>
</body>
</html>